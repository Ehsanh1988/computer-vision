"""Model config in json format"""


'''
IF  lr_callback  'type' == 'cosine_learning_rate_decay'  THEN   'params' : {'warmup_epoch' : 10} 
'''


################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
#16 _ 80  0.0002 0.1
# 698/698 [==============================] - 9s 13ms/step - loss: 0.3018 - accuracy: 0.9370 - Precision-tr-0.5: 0.9499 - Precision-tr-0.9: 0.9787 - fp: 34.0000 - fn: 53.0000 - recall-tr--0.5: 0.9241 - recall-tr--0.9: 0.8539   

#16 _ 50  0.0002 0.1
#698/698 [==============================] - 9s 13ms/step - loss: 0.3295 - accuracy: 0.9269 - Precision-tr-0.5: 0.9398 - Precision-tr-0.9: 0.9788 - fp: 41.0000 - fn: 58.0000 - recall-tr--0.5: 0.9169 - recall-tr--0.9: 0.8596 
#698/698 [==============================] - 9s 13ms/step - loss: 0.3128 - accuracy: 0.9255 - Precision-tr-0.5: 0.9373 - Precision-tr-0.9: 0.9742 - fp: 43.0000 - fn: 55.0000 - recall-tr--0.5: 0.9212 - recall-tr--0.9: 0.8653 

#16 _ 50  0.0002 0.0
#698/698 [==============================] - 10s 13ms/step - loss: 0.3686 - accuracy: 0.9126 - Precision-tr-0.5: 0.9296 - Precision-tr-0.9: 0.9671 - fp: 48.0000 - fn: 64.0000 - recall-tr--0.5: 0.9083 - recall-tr--0.9: 0.8424 
CFG_RESNET50 = {
    "data": {
        "path_to_data" : "/workspace/detect-me/product_classifier/data/",
        "path_to_model" : "/workspace/detect-me/product_classifier/saved_models/",
        "image_size": (224,224)
    },
    "train": {
        "batch_size": 18,
        "epochs": 25,
        "opt_lr" : 0.0088,
        "fine_tune_at": 120,
        'dropout' : 0.1,
        "optimizer": {
            "type": "adam",
            "lr_callback" : { 'type' : 'cosine_learning_rate_decay', #cosine_learning_rate_decay',
                              'params' : {'warmup_epoch' : 4,
                                          'hold_base_rate_steps' : 1} 
                             }
        },
        "metrics": [""]
    },
    "model": {
        "name" : 'RESNET50'
    }
}
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################


#22 30 002 80 0.1 cosine(10 2) False
# #718/718 [==============================] - 10s 13ms/step - loss: 0.3512 - accuracy: 0.9262 - Precision-tr-0.5: 0.9353 - Precision-tr-0.9: 0.9743 - fp: 46.0000 - fn: 53.0000 - recall-tr--0.5: 0.9262 - recall-tr--0.9: 0.8969  
CFG_RESNET50V2 = {
    "data": {
        "path_to_data" : "/workspace/detect-me/product_classifier/data/",
        "path_to_model" : "/workspace/detect-me/product_classifier/saved_models/",
        "image_size": (224,224)
    },
    "train": {
        "batch_size": 32,
        "epochs": 30,
        "opt_lr" : 0.0001,
        "fine_tune_at": 0,
        'dropout' : 0.0,
        "optimizer": {
            "type": "adam",
            "lr_callback" : { 'type' : 'cosine_learning_rate_decay', #cosine_learning_rate_decay
                              'params' : {'warmup_epoch' : 0,
                                          'hold_base_rate_steps' : 4} 
                             }
        },
        "metrics": [""]
    },
    "model": {
        "name" : 'RESNET50V2'
    }
}
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################

# 16 0002 300 0.2
# 700/700 [==============================] - 21s 30ms/step - loss: 1.5517 - accuracy: 0.6471 - Precision-tr-0.5: 0.7242 - Precision-tr-0.9: 0.8923 - fp: 163.0000 - fn: 272.0000 - recall-tr--0.5: 0.6114 - recall-tr--0.9: 0.4614

# 16 0002 300 0.2
# 700/700 [==============================] - 21s 30ms/step - loss: 1.5517 - accuracy: 0.6471 - Precision-tr-0.5: 0.7242 - Precision-tr-0.9: 0.8923 - fp: 163.0000 - fn: 272.0000 - recall-tr--0.5: 0.6114 - recall-tr--0.9: 0.4614

# 16 0002 20 0.0
#700/700 [==============================] - 21s 30ms/step - loss: 0.7228 - accuracy: 0.8429 - Precision-tr-0.5: 0.8576 - Precision-tr-0.9: 0.9505 - fp: 96.0000 - fn: 122.0000 - recall-tr--0.5: 0.8257 - recall-tr--0.9: 0.7400   


# 16 0002 with learning decay  20 0.0
# 700/700 [==============================] - 21s 29ms/step - loss: 0.7081 - accuracy: 0.8629 - Precision-tr-0.5: 0.8813 - Precision-tr-0.9: 0.9512 - fp: 80.0000 - fn: 106.0000 - recall-tr--0.5: 0.8486 - recall-tr--0.9: 0.7800 


#700/700 [==============================] - 21s 30ms/step - loss: 1.1992 - accuracy: 0.7500 - Precision-tr-0.5: 0.8164 - Precision-tr-0.9: 0.9289 - fp: 114.0000 - fn: 193.0000 - recall-tr--0.5: 0.7243 - recall-tr--0.9: 0.5971 
CFG_RESNET152 = {
    "data": {
        "path_to_data" : "/workspace/detect-me/product_classifier/data/",
        "path_to_model" : "/workspace/detect-me/product_classifier/saved_models/",
        "image_size": (224,224)
    },
    "train": {
        "batch_size": 16,
        "epochs": 25,
        "opt_lr" : 0.0004,
        "fine_tune_at": 500,
        'dropout' : 0.4,
        "optimizer": {
            "type": "adam",
            "lr_callback" : { 'type' : 'cosine_learning_rate_decay',
                              'params' : {'warmup_epoch' : 5,
                                          'hold_base_rate_steps' : 2} 
                             }
        },
        "metrics": [""]
    },
    "model": {
        "name" : 'RESNET152V2' #      RESNET50  |  RESNET152V2  |  RESNET50V2
    }
}

################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################

CFG_VGG16 = {
    "data": {
        "path_to_data" : "/workspace/detect-me/product_classifier/data",
        "path_to_model" : "/workspace/detect-me/product_classifier/saved_models/",
        "image_size": (224,224)
    },
    "train": {
        "batch_size": 32,
        "epochs": 50,
        "opt_lr" : 0.0002,
        "fine_tune_at": 0,
        'dropout' : 0.0,
        "optimizer": {
            "type": "adam",
            "lr_callback" : { 'type' : 'cosine_learning_rate_decay',
                              'params' : {'warmup_epoch' : 4,
                                          'hold_base_rate_steps' : 3} 
                             }
        },
        "metrics": [""]
    },
    "model": {
        "name" : 'VGG16'
    }
}

################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################

# 718/718 [==============================] - 30s 42ms/step - loss: 0.2536 - accuracy: 0.9345 - Precision-tr-0.5: 0.9463 - Precision-tr-0.9: 0.9788 - fp: 38.0000 - fn: 49.0000 - recall-tr--0.5: 0.9318 - recall-tr--0.9: 0.8983  
CFG_EfficientNet = {
    "data": {
        "path_to_data" : "/workspace/detect-me/product_classifier/data",
        "path_to_model" : "/workspace/detect-me/product_classifier/saved_models/",
        "image_size": (224,224)
    },
    "train": {
        "batch_size": 16,
        "epochs": 40,
        "opt_lr" : 0.0005,
        "fine_tune_at": 400,   
        'dropout' : 0.2,
        "optimizer": {
            "type": "adam",
            "lr_callback" : { 'type' : 'cosine_learning_rate_decay',# 'cosine_learning_rate_decay',
                              'params' : {'warmup_epoch' : 0,
                                          'hold_base_rate_steps' : 4} 
                             }
        },
        "metrics": [""]
    },
    "model": {
        "name" : 'EfficientNetB7'
    }
}
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################
################################################################################################################################################################################################################################################################################################################################


CFG_DENSE201 = {
    "data": {
        "path_to_data" : "/workspace/detect-me/product_classifier/data",
        "path_to_model" : "/workspace/detect-me/product_classifier/saved_models/",
        "image_size": (224,224)
    },
    "train": {
        "batch_size": 16,
        "epochs": 30,
        "opt_lr" : 0.001,
        "fine_tune_at": 0,   
        'dropout' : 0.4,
        "optimizer": {
            "type": "adam",
            "lr_callback" : { 'type' : 'cosine_learning_rate_decay',# 'cosine_learning_rate_decay',
                              'params' : {'warmup_epoch' : 5,
                                          'hold_base_rate_steps' : 2} 
                             }
        },
        "metrics": [""]
    },
    "model": {
        "name" : 'DenseNet201'
    }
}



CFG_DENSE121 = {
    "data": {
        "path_to_data" : "/workspace/detect-me/product_classifier/data",
        "path_to_model" : "/workspace/detect-me/product_classifier/saved_models/",
        "image_size": (224,224)
    },
    "train": {
        "batch_size": 32,
        "epochs": 25,
        "opt_lr" : 0.001,
        "fine_tune_at": 0,   
        'dropout' : 0.3,
        "optimizer": {
            "type": "adam",
            "lr_callback" : { 'type' : 'cosine_learning_rate_decay',# 'cosine_learning_rate_decay',
                              'params' : {'warmup_epoch' : 4,
                                          'hold_base_rate_steps' : 2} 
                             }
        },
        "metrics": [""]
    },
    "model": {
        "name" : 'DenseNet121'
    }
}

CFG_NASNET = {
    "data": {
        "path_to_data" : "/workspace/detect-me/product_classifier/data",
        "path_to_model" : "/workspace/detect-me/product_classifier/saved_models/",
        "image_size": (224,224)
    },
    "train": {
        "batch_size": 4,
        "epochs": 40,
        "opt_lr" : 0.0044,
        "fine_tune_at": 20,   
        'dropout' : 0.0,
        "optimizer": {
            "type": "adam",
            "lr_callback" : { 'type' : 'cosine_learning_rate_decay',# 'cosine_learning_rate_decay',
                              'params' : {'warmup_epoch' : 8,
                                          'hold_base_rate_steps' : 2} 
                             }
        },
        "metrics": [""]
    },
    "model": {
        "name" : 'NASNetLarge'
    }
}

CFG_INCEPTION_RES = {
    "data": {
        "path_to_data" : "/workspace/detect-me/product_classifier/data",
        "path_to_model" : "/workspace/detect-me/product_classifier/saved_models/",
        "image_size": (224,224)
    },
    "train": {
        "batch_size": 16,
        "epochs": 40,
        "opt_lr" : 0.002,
        "fine_tune_at": 20,   
        'dropout' : 0.4,
        "optimizer": {
            "type": "adam",
            "lr_callback" : { 'type' : 'cosine_learning_rate_decay',# 'cosine_learning_rate_decay',
                              'params' : {'warmup_epoch' : 4,
                                          'hold_base_rate_steps' : 2} 
                             }
        },
        "metrics": [""]
    },
    "model": {
        "name" : 'INCEPTION_RES'
    }
}